<dom-module id="submit-startup">
  <template>
    <style is="custom-style">
      .container {
        max-width: 1000px;
        position: relative;
        text-align: center;
      }

      .submit__container {
        position: relative;
      }

      .section__description {
        color: #5D5D5D;
        font-size: 1.595rem;
        line-height: 1.5;
        margin-bottom: 1rem;
        margin-top: 1rem;
        text-align: center;
      }

      .section__description-startup, .section__description-startup p, .section__subheader-startup p {
        margin-top: 0;
        font-size: 1.35rem;
        font-weight: 400;
        line-height: 1.85;
        text-align: left;
      }

      .section__description-startup br {
        line-height: 3.3;
      }

      .section__description b {
        display: inline;
        font-size: 1.35rem;
        font-weight: 700;
        line-height: 1.8;
        margin-top: 1rem;
        text-align: left;
      }

      .section__break--thin {
        border-color: black;
        margin-bottom: 3.5rem;
        margin-top: 4.5rem;
      }

      .section__subheader {
        font-size: 2.3rem;
        font-weight: 500;
        letter-spacing: 0.0325rem;
        margin-bottom: 2.5rem;
      }

      .section__subheader-startup {
        color: #5D5D5D;
        font-size: 2rem;
        letter-spacing: 0;
        margin-top: 3.5rem;
        margin-bottom: 0;
        text-align: left;
      }

      .section__subheader-startup span {
        font-weight: bold;
        font-size: 3rem;
        line-height: 50px;
      }

      .section__icon--wide {
        margin-bottom: 0.9rem;
        margin-top: 2rem;
        width: 90%;
      }

      .section__back {
        background-color: transparent;
        border: none;
        cursor: pointer;
        font-size: 0.9rem;
        left: 1.5%;
        position: absolute;
        text-decoration: underline;
        text-transform: uppercase;
      }

      .section__back i {
          color: #55bb6e;
          font-size: 45px;
          line-height: 1.2;
      }

      [data-target="startup"] .section__back {
        top: 1.75%;
      }

      [data-target="office-entry-form"] .section__back {
        top: 8%;
      }

      [data-target="office-submission-form"] .section__back {
        top: 0.75%;
      }

      .js-hidden {
        display: none;
      }

      [data-target="main"].js-hidden {
        position: relative;
      }

      button.fade-in{
        animation-delay: 0.525s !important;
      }

      .accordion {
        list-style-type: none;
        margin: 3rem 0 6rem auto;
        padding-left: 6.7rem;
        text-align: left;
      }

      .accordion__section:not(:last-of-type) {
        border-bottom: 1px solid black;
      }

      .accordion__header {
        cursor: pointer;
        font-size: 1.35rem;
        font-weight: 600;
        letter-spacing: 0.06rem;
        margin: 0;
        padding: 3.3rem 0;
        position: relative;
        transition: all 0.5s;
      }

      .accordion__header:hover {
        color: #33B8B8;
      }

      .accordion__content {
        opacity: 1;
        padding-bottom: 3.3rem;
        position: relative;
        transform: translateY(0);
        transition: position 0.5s, opacity 0.5s, transform 0.5s;
      }

      .accordion__content--toggle {
        opacity: 0;
        position: absolute;
        transform: translateY(-5%);
      }

      /* Submit startups */
      .faq {
        margin-top: 5.8rem;
        list-style-type: none;
        padding-left: 2rem;
      }

      .faq__list {
        color: #5D5D5D;
        margin-top: 2rem;
        padding-left: 2.75rem;
        text-align: left;
      }

      .faq__step {
        margin: 5.25rem 0;
      }
      .faq__step:last-of-type {
        margin-bottom: 0;
      }

      .faq__name {
        color: #000000;
        font-size: 2rem;
        font-weight: 800;
        line-height: 0.45;
      }

      .faq__description {
        color: #000000;
        display: block;
        font-size: 1.465rem;
      }

      .faq__requirement {
        font-size: 1.46rem;
        list-style-type: disc;
        line-height: 1.7;
        padding-left: 0.8rem;
        word-spacing: 0.155rem;
      }

      .faq a {
        color: #333399;
        text-decoration: none;
      }

      .faq__submit {
        text-align: center;
      }

      .faq__submit-link {
        background-color: #0099FF;
        color: #FFFFFF !important;
        font-size: 1.5rem;
        font-weight: 400;
        height: 55px;
        line-height: 2.65;
        margin-top: 2.5rem;
        max-width: 245px;
        text-transform: uppercase;
        width: 100%;
      }

      .faq em, .faq i {
        word-spacing: normal;
      }

      .summary {
        align-items: flex-start;
        display: flex;
        margin-top: 4.3rem;
      }

      .summary__icon {
        padding-top: 0.8rem;
        width: 17%;
      }

      .summary__content {
        margin-bottom: 4rem;
        margin-left: 2rem;
        text-align: left;
      }

      .summary__title {
        font-size: 2rem;
        font-weight: 600;
        line-height: 2;
        margin: 0;
      }

      .summary__content--container {
        display: inline-block;
        font-size: 1.45rem;
        margin-bottom: 1.15rem;
      }

      .summary__content em, .summary__content i {
        display: block;
      }

      .summary__content a {
        border: 2px solid #2EAFAC;
        color: #2EAFAC;
        display: table;
        font-size: 1.5rem;
        font-weight: 700;
        margin-top: 2.2rem;
        padding: 0.7rem 3.9rem;
        text-decoration: none;
      }

      @media (max-width: 1200px) {
        .submit__container {
          padding-top: 3rem;
        }

        .section__back {
          left: 50%;
          transform: translateX(-50%);
        }

        [data-target="startup"] .section__back {
          top: 1.5%;
        }

        [data-target="office-entry-form"] .section__back {
          top: 9%;
        }

        [data-target="office-submission-form"] .section__back {
          top: 1%;
        }
      }

      @media (max-width: 920px) {
        .section__back {
          float: none;
        }

        .faq__list {
          padding-left: 0;
        }

        .section__break--thin {
          margin-left: 0;
        }

        .summary, .summary__content {
          margin-left: 0;
        }

        .summary__icon {
          width: 20%;
        }
      }

      @media (max-width: 680px) {
        .accordion {
          margin-bottom: 0;
          padding-left: 4.5rem;
        }

        .section__subheader {
          font-size: 2rem;
          margin-bottom: 0;
        }

        .summary {
          text-align: center;
        }

        .summary__icon {
          display: none;
        }
      }

      @media (max-width: 480px) {
        .section__icon--wide {
          display: none;
        }
      }

      @media (max-width: 380px) {
        .accordion {
          padding-left: 0;
        }

        .accordion__header {
          font-size: 1.2rem;
        }
      }
    </style>
    <style is="custom-style" include="style-fade-in"></style>
    <firebase-document
      app-name="unicef-innovation-fund"
      path="/content/submit_content"
      data="{{submit}}">
    </firebase-document>

    <button on-tap="changeSection" class="section__back" data-display="main" data-hide="startup">
        <i class="material-icons">arrow_back</i>
    </button>
    <div class="mdl-layout-spacer"></div>
    <div class="container mdl-cell mdl-cell--12-col" style='padding:50px;'>
      <h3 class="section__subheader section__subheader-startup">
            <span>
              <echo-html html$="{{submit.startups.title}}"></echo-html>
            </span>

      </h3>
      <p class="section__description section__description-startup">
        <echo-html html$="{{submit.startups.description}}"></echo-html>
      </p>
      <br />
      <br />
      <p class="section__description section__description-startup">
        <echo-html html$="{{submit.startups.process_description}}"></echo-html>
        <img src="../../images/icons/startup_submit-line_3.svg" alt="Submissions by country offices" class="section__icon--wide"/>
        <br />
        <echo-html html$="{{submit.startups.process_description_2}}"></echo-html>
        <br />
        <img src="../../images/icons/startup_submit-line_3.svg" alt="Submissions by country offices" class="section__icon--wide"/>
        <br />
        <echo-html html$="{{submit.startups.process_description_3}}"></echo-html>
        <br />
        <br />

        <echo-html html$="{{submit.startups.process_description_4}}"></echo-html>
      </p>
      <br />
      <br />
      <p class="section__description section__description-startup">
        <img src="../../images/icons/startup_submit-line_3.svg" alt="Submissions by country offices" class="section__icon--wide"/>
      </p>

      <h3 class="section__subheader section__subheader-startup">
        <echo-html html$="{{submit.startups.process_title}}"></echo-html>
      </h3>
      <img src="../../images/icons/startup_submit_steps.svg" alt="Steps for startup" class="section__icon--wide">
      <p class="section__description section__subheader-startup"></p>
      <ol class="accordion">
        <li class="accordion__section">
          <h1 class="accordion__header" style='text-align:center;position:relative;top:-30px;left:-70px;' data-open$="accordion-{{stepIndex(index)}}" on-tap="accordionOpenStartUp">
            <div style='color:#6A1E74; border:solid #6A1E74 3px;padding:15px 20px 15px 50px; display:inline;'>
              VIEW STEPS
              <img src="../../images/icons/arrow.svg" alt="open accordion" class="accordion__arrow_startup" style='postion:relative;display:inline;width:40px;'>
            </div>

          </h1>
          <div class="accordion__content accordion__content--toggle" data-accordion$="accordion-{{stepIndex(index)}}">
            <ol class="faq faq__list">
              <template is="dom-repeat" items="{{submit.startups.steps}}" as="step">
                <li class="faq__step">
                  <h3 class="faq__name"><echo-html html$="{{step.name}}"></echo-html></h3>
                  <strong class="faq__description"><echo-html html$="{{step.description}}"></echo-html></strong>
                  <ul class="faq__list">
                    <template is="dom-repeat" items="{{step.requirements}}" as="requirement">
                      <li class="faq__requirement">
                        <echo-html html$="{{requirement}}"></echo-html>
                      </li>
                    </template>
                  </ul>
                </li>
              </template>
            </ol>
            <div class="faq__submit">
              <a href="https://www.jotform.us/70894154871162" class="faq__submit-link mdl-button mdl-js-button mdl-js-ripple-effect" target="_blank">
                <echo-html html$="{{submit.startups.submit_button_text}}"></echo-html>
              </a>
            </div>
          </div>
        </li>
      </ol>
      <hr class="section__break--thin">
      <div class="summary">
        <img src="../../images/icons/country_offices-alt.svg" alt="" class="summary__icon">
        <div class="summary__content">
          <h3 class="summary__title"><echo-html html$="{{submit.startups.additional_info_title}}"></echo-html></h3>
          <template is="dom-repeat" items="{{submit.startups.additional_info}}" as="info">
                  <span class="summary__content--container">
                      <echo-html html$="{{info}}"></echo-html>
                  </span>
          </template>
        </div>
      </div>
    </div>
    <div class="mdl-layout-spacer"></div>
  </template>
  <script>
      Polymer({
          is: "submit-startup",
          properties: {
              countryOfficesAuthenticated: {
                  type: Boolean,
                  value: false
              },
              errorMessageClass: {
                  type: String,
                  value: ''
              },
              errorMessage: {
                  type: String,
                  value: 'Email is not valid'
              },
              inputAuthClass: {
                  type: String,
                  value: ''
              },
              sectionName: {
                  type: String,
                  value: 'Country offices and startups'
              },
              startups: {
                  type: Object
              },
              submit: {
                  type: Object
              }
          },
          listeners: {
              'iron-form-submit': 'submitEmail'
          },
          stepIndex: function (index) {
              return index + 1;
          },
          ready: function () {
              var self = this;
              var visibleClass = "js-visible";
              var hiddenClass = "js-hidden";
              $(document).on('page-changed', function(e, page_id){
                  if (page_id !== 'submit' && !self.selected) {
                      var currentElement = self.$$("." + visibleClass);
                      var mainElement = self.$$("[data-target='main']");
                      var inputMail = self.$$(".section__input");
                      var pageHeader = self.$$(".page__header--type");

                      currentElement.classList.remove(visibleClass);
                      currentElement.classList.add(hiddenClass);

                      mainElement.classList.remove(hiddenClass);
                      mainElement.classList.add(visibleClass);

                      inputMail.value = '';
                      pageHeader.innerHTML = '';
                      self.inputAuthClass = '';
                      self.errorMessageClass = '';
                      self.countryOfficesAuthenticated = false;
                      self.errorMessage = 'Email is not valid';
                  }
              });
          },
          attached: function() {
              var self = this;
              self.initScrollReveal();
              $(document).on('page-changed', function(e, page_id) {
                  if (page_id == 'submit') {
                      self.initScrollReveal();
                  }
              });
          },
          initScrollReveal: function() {
              var config = { container: '#mainContainer' };
              if (!window.scrollReveal) {
                  window.scrollReveal = new ScrollReveal();
              }
              window.scrollReveal.reveal('.accordion__section, .role__list, .section__subheader:not(:first-child), .faq__step, '
                  + '.faq__submit, .summary', config);
          },
          toggleVisible: function(toHide, toShow) {
              var visibleClass = "js-visible";
              var hiddenClass = "js-hidden";

              toHide.classList.remove(visibleClass);
              toHide.classList.add(hiddenClass);

              toShow.classList.remove(hiddenClass);
              toShow.classList.add(visibleClass);
          },
          changeSection: function(event) {
              this.domHost.changeSection(event);
          },
          submitEmail: function(event) {
              event.preventDefault();
              var emailAddress = this.$$(".section__input").value;
              var submitButton = this.$$('.section__confirm-email');

              var toHide = this.$$("[data-target='" + submitButton.dataset.hide + "']");
              var toShow = this.$$("[data-target='" + submitButton.dataset.display + "']");

              if (this.countryOfficesAuthenticated === true) {
                  this.toggleVisible(toHide, toShow);
              } else {
                  this.errorMessageClass = 'is-visible';
              }

          },

          accordionOpenStartUp: function (event) {
              var target = event.currentTarget;
              var taped = target.dataset.open;
              var selected = this.$$("[data-accordion='" + taped + "']");
              var arrow = target.querySelector('.accordion__arrow_startup');

              arrow.classList.toggle('accordion__arrow_startup--toggle')
              selected.classList.toggle('accordion__content--toggle');
          },
          accordionOpen: function (event) {
              var target = event.currentTarget;
              var taped = target.dataset.open;
              var selected = this.$$("[data-accordion='" + taped + "']");
              var arrow = target.querySelector('.accordion__arrow');

              arrow.classList.toggle('accordion__arrow--toggle')
              selected.classList.toggle('accordion__content--toggle');
          },
          _getCategoryIconPath: function(category) {
              if (category) {
                  return '/images/icons/' + category + '.svg';
              }
          },
      })
  </script>
</dom-module>
