<dom-module id="submit-page">
  <template>
    <style is="custom-style">
      .container {
        width: 100%
        position: relative;
        text-align: center;
      }

      .container--wide {
        margin: 0 auto;
        max-width: 1920px;
      }

      .button:hover {
        background-color: #FFFFFF;
        box-shadow: 2px 2px 10px 0 #999999;
        z-index: 1;
      }

      .submit__office {
        text-align: left;
        padding-top: 40px;
      }

      .button__container {
        font-size: 0;
      }

      .button__text {
        font-size: 1.35rem;
        margin-bottom: 35px;
      }

      .button__image {
        max-height: 80px;
      }

      .button--big {
        background-color: #FFFFFF;
        color: #0068EA;
        display: inline-block;
        font-size: 1.2rem;
        height: 252px;
        padding: 0;
        text-transform: none;
        width: 50%;
      }

      .submit__container {
        position: relative;
      }

      .submit__icon {
        display: block;
      }

      .section__description {
        color: #5D5D5D;
        font-size: 1.595rem;
        line-height: 1.5;
        margin-bottom: 1rem;
        margin-top: 1rem;
        text-align: center;
      }

      .section__description-startup, .section__description-startup p, .section__subheader-startup p {
        margin-top: 0;
        font-size: 1.35rem;
        font-weight: 400;
        line-height: 1.85;
        text-align: left;
      }

      .section__description-startup br {
        line-height: 3.3;
      }

      .section__description b {
        display: inline;
        font-size: 1.35rem;
        font-weight: 700;
        line-height: 1.8;
        margin-top: 1rem;
        text-align: left;
      }

      .section__submit {
        text-align: center;
      }

      .section__submit-link {
        background-color: #7348B3;
        color: white;
        font-size: 1.15rem;
        font-weight: 400;
        height: 44px;
        line-height: 2.75;
        margin-top: 2.5rem;
        max-width: 260px;
        text-transform: uppercase;
        width: 100%;
      }

      .section__submit-link:link {
        background-color: #7348B3;
      }

      .section__submit-link:visited {
        background-color: #7348B3;
      }

      .section__submit-link:hover {
        background-color: #77C2E2;
      }

      .section__submit-link:active {
        background-color: #7348B3;
      }

      .section__submit-link:focus {
        background-color: #7348B3;
      }

      .section__break {
        border-top: 3px solid #727272;
        margin: 4rem 0 4.75rem;
      }

      .section__break--short {
        display: block;
        margin-top: 6.7rem;
        margin-bottom: 3.5rem;
        margin-left: auto;
        margin-right: auto;
        text-align: center;
        width: 20%;
      }

      .section__break--thin {
        border-color: black;
        margin-bottom: 3.5rem;
        margin-top: 4.5rem;
      }

      .section__subheader {
        font-size: 2.3rem;
        font-weight: 500;
        letter-spacing: 0.0325rem;
        margin-bottom: 2.5rem;
      }

      .section__subheader-startup {
        color: #5D5D5D;
        font-size: 2rem;
        letter-spacing: 0;
        margin-top: 3.5rem;
        margin-bottom: 0;
        text-align: left;
      }

      .section__subheader-startup span {
        font-weight: bold;
        font-size: 3rem;
        line-height: 50px;
      }
      .section__icon {
        width: 15%;
      }

      .section__icon--wide {
        margin-bottom: 0.9rem;
        margin-top: 2rem;
        width: 90%;
      }

      .section__link {
        text-decoration: none;
      }

      .section__back {
        cursor: pointer;
        font-size: 45px;
        line-height: 1.2;
      }

      [data-target="startup"] .section__back {
        top: 1.75%;
      }

      .section__input {
        border: 2px solid #BABCBD;
        color: #7348B3;
        display: block;
        font-size: 1.1rem;
        margin: 0 auto;
        padding: 1.1rem;
        width: 228px;
      }

      .section__input--authenticated {
        background: url('../../images/confirm.svg') no-repeat 97% center;
        background-size: 7%;
      }

      .section__input:focus {
        outline: none
      }

      .section__confirm-email {
        background-color: #7348B3;
        border: none;
        color: #FFFFFF;
        cursor: pointer;
        font-size: 0.93rem;
        font-weight: 400;
        margin-top: 0.8rem;
        padding: 1.0375rem 0;
        text-transform: uppercase;
        width: 260px;
      }

      .section__confirm-email:disabled {
        background-color: #BABCBD;
        color: #5D5D5D;
      }

      .section__auth-alert {
        color: red;
        font-size: 1.1rem;
        margin-bottom: 0.5rem;
        opacity: 0;
        transition: opacity 0.25s;
      }

      .is-visible {
        opacity: 1;
      }

      .js-visible {
        display: block;
      }

      .js-hidden {
        display: none;
      }

      [data-target="main"].js-hidden {
        position: relative;
      }

      button.fade-in{
        animation-delay: 0.525s !important;
      }

      .is-alert {
        color: red !important;
      }

      .accordion {
        list-style-type: none;
        margin: 3rem 0 6rem auto;
        padding-left: 6.7rem;
        text-align: left;
      }

      .accordion__section:not(:last-of-type) {
        border-bottom: 1px solid black;
      }

      .accordion__header {
        cursor: pointer;
        font-size: 1.35rem;
        font-weight: 600;
        letter-spacing: 0.06rem;
        margin: 0;
        padding: 3.3rem 0;
        position: relative;
        transition: all 0.5s;
      }

      .accordion__header:hover {
        color: #33B8B8;
      }

      .accordion__number {
        text-align: center;
        width: 30px;
        border: 3px solid #33B8B8;
        border-radius: 50%;
        color: #33B8B8;
        display: inline-block;
        font-weight: 600;
        font-size: 1.5em;
        left: -6.75rem;
        line-height: 0.50;
        padding: 1.65rem;
        position: absolute;
        transform: translateY(-25%);
      }

      .accordion__arrow {
        position: absolute;
        width: 50px;
        right: 1%;
        top: 50%;
        transform: translateY(-50%);
      }

      .accordion__arrow--toggle {
        transform: translateY(-50%) scaleY(-1);
      }


      .accordion__arrow_startup--toggle {
        transform: translateY(0%) scaleY(-1);
      }

      .accordion__content {
        opacity: 1;
        padding-bottom: 3.3rem;
        position: relative;
        transform: translateY(0);
        transition: position 0.5s, opacity 0.5s, transform 0.5s;
      }

      .accordion__content--toggle {
        opacity: 0;
        position: absolute;
        transform: translateY(-5%);
      }

      .accordion__summary {
        font-size: 1.3rem;
        font-weight: 600;
        letter-spacing: 0.0625rem;
        margin-bottom: 0.5rem;
      }

      .accordion__summary--gray {
        color: #5D5D5D;
        font-size: 1.25rem;
        font-weight: 600;
        letter-spacing: 0.0625rem;
        line-height: 1.7;
        margin-bottom: 2rem;
      }

      .description__list {
        color: #5D5D5D;
        list-style-type: none;
        padding-left: 0;
      }

      .description__item {
        font-size: 1.3rem;
        line-height: 1.7;
      }

      .role__list {
        list-style-type: none;
        margin-bottom: 5rem;
        padding-left: 0;
        padding-top: 1rem;
      }

      .role__item {
        padding: 1.3rem 0 3rem 6.75rem;
      }

      .role__info {
        padding-left: 4rem;
        text-align: left;
      }

      .role__name {
        color: #000000;
        font-weight: 600;
        font-size: 1.5rem;
        margin-bottom: 0;
        position: relative;
        text-transform: uppercase;
      }

      .role__image {
        left: -5rem;
        margin-bottom: 0;
        max-width: 35px;
        position: absolute;
        top: 100%;
        transform: translate(-50%, -50%);
      }

      .role__description {
        color: #5D5D5D;
        font-size: 1.5rem;
        line-height: 1.5;
      }

      /*Submit startups*/
      .faq {
        margin-top: 5.8rem;
        list-style-type: none;
        padding-left: 2rem;
      }

      .faq__list {
        color: #5D5D5D;
        margin-top: 2rem;
        padding-left: 2.75rem;
        text-align: left;
      }

      .faq__step {
        margin: 5.25rem 0;
      }
      .faq__step:last-of-type {
        margin-bottom: 0;
      }

      .faq__name {
        color: #000000;
        font-size: 2rem;
        font-weight: 800;
        line-height: 0.45;
      }

      .faq__description {
        color: #000000;
        display: block;
        font-size: 1.465rem;
      }

      .faq__requirement {
        font-size: 1.46rem;
        list-style-type: disc;
        line-height: 1.7;
        padding-left: 0.8rem;
        word-spacing: 0.155rem;
      }

      .faq a {
        color: #333399;
        text-decoration: none;
      }

      .faq__submit {
        text-align: center;
      }

      .faq__submit-link {
        background-color: #7348B3;
        color: #FFFFFF !important;
        font-size: 1.5rem;
        font-weight: 400;
        height: 55px;
        line-height: 2.65;
        margin-top: 2.5rem;
        max-width: 245px;
        text-transform: uppercase;
        width: 100%;
      }

      .faq em, .faq i {
        word-spacing: normal;
      }

      .faq__button {
        border: 2px solid #2EAFAC;
        color: #2EAFAC;
        display: table;
        font-weight: 800;
        margin: 1rem 0;
        padding: 0.2rem 4.25rem;
        text-decoration: none;
      }

      .summary {
        align-items: flex-start;
        display: flex;
        margin-top: 4.3rem;
      }

      .summary__icon {
        padding-top: 0.8rem;
        width: 17%;
      }

      .summary__content {
        margin-bottom: 4rem;
        margin-left: 2rem;
        text-align: left;
      }

      .summary__title {
        font-size: 2rem;
        font-weight: 600;
        line-height: 2;
        margin: 0;
      }

      .summary__content--container {
        display: inline-block;
        font-size: 1.45rem;
        margin-bottom: 1.15rem;
      }

      .summary__content em, .summary__content i {
        display: block;
      }

      .summary__content a {
        border: 2px solid #2EAFAC;
        color: #2EAFAC;
        display: table;
        font-size: 1.5rem;
        font-weight: 700;
        margin-top: 2.2rem;
        padding: 0.7rem 3.9rem;
        text-decoration: none;
      }

      .submit__container .container .section__form {
        padding-bottom: 40px;
      }

      @media (max-width: 1200px) {
        .submit__container {
          padding-top: 3rem;
        }

        .section__back {
          left: 50%;
          transform: translateX(-50%);
        }

        [data-target="startup"] .section__back {
          top: 1.5%;
        }
      }

      @media (max-width: 1120px) {
        .button--big {
          font-size: 2rem;
          height: 250px;
        }
      }

      @media (max-width: 920px) {
        .section__back {
          float: none;
        }

        .faq__list {
          padding-left: 0;
        }

        .section__break--thin {
          margin-left: 0;
        }

        .summary, .summary__content {
          margin-left: 0;
        }

        .summary__icon {
          width: 20%;
        }
      }

      @media (min-width: 680px) {
        .button:first-of-type:after {
          border-right: 2px solid #58595B;
          content: '';
          height: 60%;
          position: absolute;
          right: 0;
          top: 50%;
          transform: translateY(-50%);
        }
      }

      @media (max-width: 680px) {
        .button--big {
          display: block;
          float: none;
          width: 100%;
        }

        .accordion {
          margin-bottom: 0;
          padding-left: 4.5rem;
        }

        .accordion__number {
          border-width: 2px;
          left: -4.25rem;
          line-height: 0.55;
          padding: 1.1rem;
          top: 50%;
          transform: translateY(-50%);
        }

        .section__subheader {
          font-size: 2rem;
          margin-bottom: 0;
        }

        .role__item {
          padding: 1rem 0 0 3.75rem;
        }

        .role__image {
          left: -2rem;
          max-width: 30px;
        }

        .role__description {
          font-size: 1.2rem;
        }

        .faq__button {
          margin: 1rem auto;
        }

        .summary {
          text-align: center;
        }

        .summary__icon {
          display: none;
        }
      }

      @media (max-width: 480px) {
        .page__header--type {
          font-size: 2rem;
        }

        .section__input {
          width: 91%;
        }

        .section__confirm-email {
          width: 100%;
        }

        .section__icon--wide {
          display: none;
        }
      }

      @media (max-width: 380px) {
        .page__header--type {
          font-size: 1.75rem;
        }

        .section__input {
          width: 88%;
        }

        .accordion {
          padding-left: 0;
        }

        .accordion__header {
          font-size: 1.2rem;
        }

        .accordion__number {
          display: none;
        }
      }
      .submit_separator {
        width:120px;
        height:4px;
        background-color:#6A1E74;
        position:relative; left:320px;
      }
    </style>
    <style is="custom-style" include="style-fade-in"></style>
    <firebase-document
      app-name="unicef-innovation-fund"
      path="/content/submit_content"
      data="{{submit}}">
    </firebase-document>

    <header class='page__header page__header--dark'>
      <div class='mdl-grid container'>
        <div class="mdl-layout-spacer"></div>
        <div class="mdl-cell mdl-cell--10-col">
          <h1 class='title--big hello__title fade-in'>Submit</h1>
          <p class="page__header--type">[[sectionName]]</p>
        </div>
        <div class="mdl-layout-spacer"></div>
      </div>
    </header>
    <div class="mdl-grid js-visible submit__container" data-target="main">
      <div class="mdl-layout-spacer"></div>
      <div class="button__container container--wide mdl-cell mdl-cell--12-col">
        <button on-tap="changeSection" class="button button--big mdl-button mdl-js-button mdl-js-ripple-effect fade-in" data-display="country-office" data-hide="main">
          <p class="button__text">Submissions by UNICEF country offices</p>
          <img src="../../images/icons/country_offices_2017.svg" alt="Submissions by country offices" class="button__image"/>
        </button>
        <button on-tap="changeSection" class="button button--big mdl-button mdl-js-button mdl-js-ripple-effect fade-in" data-display="startup" data-hide="main">
          <p class="button__text">Submissions by startups</p>
          <img src="../../images/icons/startups_2017.svg" alt="Submissions by country offices" class="button__image"/>
        </button>
      </div>
      <div class="mdl-layout-spacer"></div>
    </div>
    <div class="mdl-grid js-hidden submit__container" data-target="country-office">
      <submit-country-office />
    </div>
    <div class="mdl-grid js-hidden submit__container" data-target="startup">
      <submit-startup />
    </div>
  </template>
  <script>
      Polymer({
          is: "submit-page",
          properties: {
              countryOfficesAuthenticated: {
                  type: Boolean,
                  value: false
              },
              errorMessageClass: {
                  type: String,
                  value: ''
              },
              errorMessage: {
                  type: String,
                  value: 'Email is not valid'
              },
              inputAuthClass: {
                  type: String,
                  value: ''
              },
              sectionName: {
                  type: String,
                  value: 'Country offices and startups'
              },
              startups: {
                  type: Object
              },
              submit: {
                  type: Object
              }
          },
          listeners: {
              'iron-form-submit': 'submitEmail'
          },
          stepIndex: function (index) {
              return index + 1;
          },
          ready: function () {
              var self = this;
              var visibleClass = "js-visible";
              var hiddenClass = "js-hidden";
              $(document).on('page-changed', function(e, page_id){
                  if (page_id !== 'submit' && !self.selected) {
                      var currentElement = self.$$("." + visibleClass);
                      var mainElement = self.$$("[data-target='main']");
                      var inputMail = self.$$(".section__input");
                      var pageHeader = self.$$(".page__header--type");

                      currentElement.classList.remove(visibleClass);
                      currentElement.classList.add(hiddenClass);

                      mainElement.classList.remove(hiddenClass);
                      mainElement.classList.add(visibleClass);

                      inputMail.value = '';
                      pageHeader.innerHTML = '';
                      self.inputAuthClass = '';
                      self.errorMessageClass = '';
                      self.countryOfficesAuthenticated = false;
                      self.errorMessage = 'Email is not valid';
                  }
              });
          },
          attached: function() {
              var self = this;
              self.initScrollReveal();
              $(document).on('page-changed', function(e, page_id) {
                  if (page_id == 'submit') {
                      self.initScrollReveal();
                  }
              });
          },
          initScrollReveal: function() {
              var config = { container: '#mainContainer' };
              if (!window.scrollReveal) {
                  window.scrollReveal = new ScrollReveal();
              }
              window.scrollReveal.reveal('.accordion__section, .role__list, .section__subheader:not(:first-child), .faq__step, '
                  + '.faq__submit, .summary', config);
          },
          toggleVisible: function(toHide, toShow) {
              var visibleClass = "js-visible";
              var hiddenClass = "js-hidden";

              toHide.classList.remove(visibleClass);
              toHide.classList.add(hiddenClass);

              toShow.classList.remove(hiddenClass);
              toShow.classList.add(visibleClass);
          },
          changeSection: function(event) {
              var hide = event.target.dataset.hide || event.target.parentElement.dataset.hide;
              var target = event.target.dataset.display || event.target.parentElement.dataset.display;

              switch (target) {
                  case "country-office":
                      this.sectionName = "UNICEF country offices";
                      break;
                  case "startup":
                      this.sectionName = "Startups";
                      break;
                  default:
                      this.sectionName = "Country offices and startups";
              }

              var toHide = this.$$("[data-target='" + hide + "']");
              var toShow = this.$$("[data-target='" + target + "']");

              this.toggleVisible(toHide, toShow);
          },
          submitEmail: function(event) {
              event.preventDefault();
              var emailAddress = this.$$(".section__input").value;
              var submitButton = this.$$('.section__confirm-email');

              var toHide = this.$$("[data-target='" + submitButton.dataset.hide + "']");
              var toShow = this.$$("[data-target='" + submitButton.dataset.display + "']");

              if (this.countryOfficesAuthenticated === true) {
                  this.toggleVisible(toHide, toShow);
              } else {
                  this.errorMessageClass = 'is-visible';
              }

          },

          accordionOpenStartUp: function (event) {
              var target = event.currentTarget;
              var taped = target.dataset.open;
              var selected = this.$$("[data-accordion='" + taped + "']");
              var arrow = target.querySelector('.accordion__arrow_startup');

              arrow.classList.toggle('accordion__arrow_startup--toggle')
              selected.classList.toggle('accordion__content--toggle');
          },
          accordionOpen: function (event) {
              var target = event.currentTarget;
              var taped = target.dataset.open;
              var selected = this.$$("[data-accordion='" + taped + "']");
              var arrow = target.querySelector('.accordion__arrow');

              arrow.classList.toggle('accordion__arrow--toggle')
              selected.classList.toggle('accordion__content--toggle');
          },
          _getCategoryIconPath: function(category) {
              if (category) {
                  return '/images/icons/' + category + '.svg';
              }
          },
      })
  </script>
</dom-module>
